2021-01-17 19:59:32,728	INFO services.py:1092 -- View the Ray dashboard at [1m[32mhttp://127.0.0.1:8265[39m[22m
2021-01-17 20:00:13,197	INFO tune.py:439 -- Total run time: 41.92 seconds (34.24 seconds for the tuning loop).
Working on path: /home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1
--- Data already existing
--- Model from 0
20 True
== Status ==
Memory usage on this node: 19.5/503.6 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
Bracket: Iter 4.000: None | Iter 2.000: None
Resources requested: 4/16 CPUs, 2/2 GPUs, 0.0/331.98 GiB heap, 0.0/100.93 GiB objects (0/1.0 accelerator_type:RTX)
Result logdir: /home/usuaris/veu/lluis.guardia/ray_results/inner_2021-01-17_19-59-38
Number of trials: 1/2 (1 RUNNING)
+-------------------+----------+-------+-----------+----------+-------------+---------------+-------------+
| Trial name        | status   | loc   |   dropout |   epochs |   hidden_fc |   hidden_lstm |          lr |
|-------------------+----------+-------+-----------+----------+-------------+---------------+-------------|
| inner_87df0_00000 | RUNNING  |       |       0.1 |     1000 |         512 |          1024 | 1.21226e-05 |
+-------------------+----------+-------+-----------+----------+-------------+---------------+-------------+


[2m[36m(pid=22156)[0m Epoch: 1, Loss: 54.965267181396484
[2m[36m(pid=22156)[0m Epoch: 2, Loss: 54.94409942626953
[2m[36m(pid=22156)[0m Epoch: 3, Loss: 54.97937774658203
[2m[36m(pid=22156)[0m Epoch: 4, Loss: 54.75721740722656
[2m[36m(pid=22156)[0m Epoch: 5, Loss: 54.874881744384766
[2m[36m(pid=22156)[0m Validation Loss: 19.390361785888672, Accuracy: 0.0
Result for inner_87df0_00000:
  date: 2021-01-17_19-59-56
  done: false
  experiment_id: 9aa48281a33c489bb79de6124924a9f2
  experiment_tag: 0_dropout=0.1,epochs=1000,hidden_fc=512,hidden_lstm=1024,lr=1.2123e-05
  hostname: veuc10
  iterations_since_restore: 1
  node_ip: 172.26.105.110
  pid: 22156
  should_checkpoint: true
  time_since_restore: 15.50496530532837
  time_this_iter_s: 15.50496530532837
  time_total_s: 15.50496530532837
  timestamp: 1610913596
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 87df0_00000
  valid_acc: 0.0
  valid_loss: 19.390361785888672
  
== Status ==
Memory usage on this node: 23.7/503.6 GiB
Using AsyncHyperBand: num_stopped=0
Bracket: Iter 4.000: None | Iter 2.000: None | Iter 1.000: None
Bracket: Iter 4.000: None | Iter 2.000: None
Resources requested: 4/16 CPUs, 2/2 GPUs, 0.0/331.98 GiB heap, 0.0/100.93 GiB objects (0/1.0 accelerator_type:RTX)
Current best trial: 87df0_00000 with valid_loss=19.390361785888672 and parameters={'input': 4, 'hidden_lstm': 1024, 'hidden_fc': 512, 'output': 50, 'dropout': 0.1, 'lr': 1.2122558614830293e-05, 'epochs': 1000, 'path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1', 'data_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/data', 'output_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/training_output'}
Result logdir: /home/usuaris/veu/lluis.guardia/ray_results/inner_2021-01-17_19-59-38
Number of trials: 2/2 (1 PENDING, 1 RUNNING)
+-------------------+----------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+
| Trial name        | status   | loc                  |   dropout |   epochs |   hidden_fc |   hidden_lstm |          lr |   iter |   total time (s) |   valid_loss |   valid_acc |
|-------------------+----------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------|
| inner_87df0_00000 | RUNNING  | 172.26.105.110:22156 |       0.1 |     1000 |         512 |          1024 | 1.21226e-05 |      1 |           15.505 |      19.3904 |           0 |
| inner_87df0_00001 | PENDING  |                      |       0.1 |     1000 |        2048 |          2048 | 1.33543e-06 |        |                  |              |             |
+-------------------+----------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+


[2m[36m(pid=22156)[0m Outputs training/eval saved on epoch 5
[2m[36m(pid=22156)[0m Epoch: 6, Loss: 54.931175231933594
[2m[36m(pid=22156)[0m Epoch: 7, Loss: 54.481170654296875
[2m[36m(pid=22156)[0m Epoch: 8, Loss: 54.46412658691406
[2m[36m(pid=22156)[0m Epoch: 9, Loss: 54.439369201660156
[2m[36m(pid=22156)[0m Epoch: 10, Loss: 54.53120422363281
[2m[36m(pid=22156)[0m Validation Loss: 19.3868408203125, Accuracy: 0.0
[2m[36m(pid=22156)[0m Outputs training/eval saved on epoch 10
[2m[36m(pid=22156)[0m Epoch: 11, Loss: 54.27075958251953
[2m[36m(pid=22156)[0m Epoch: 12, Loss: 54.15461730957031
[2m[36m(pid=22156)[0m Epoch: 13, Loss: 54.20998001098633
[2m[36m(pid=22156)[0m Epoch: 14, Loss: 54.023834228515625
[2m[36m(pid=22156)[0m Epoch: 15, Loss: 53.91324234008789
[2m[36m(pid=22156)[0m Validation Loss: 19.37976837158203, Accuracy: 0.0
[2m[36m(pid=22156)[0m Outputs training/eval saved on epoch 15
[2m[36m(pid=22156)[0m Epoch: 16, Loss: 53.82455825805664
[2m[36m(pid=22156)[0m Epoch: 17, Loss: 53.809425354003906
[2m[36m(pid=22156)[0m Epoch: 18, Loss: 53.972721099853516
[2m[36m(pid=22156)[0m Epoch: 19, Loss: 53.98896789550781
[2m[36m(pid=22156)[0m Epoch: 20, Loss: 53.764007568359375
[2m[36m(pid=22156)[0m Validation Loss: 19.3716983795166, Accuracy: 0.0
Result for inner_87df0_00000:
  date: 2021-01-17_19-59-56
  done: true
  experiment_id: 9aa48281a33c489bb79de6124924a9f2
  experiment_tag: 0_dropout=0.1,epochs=1000,hidden_fc=512,hidden_lstm=1024,lr=1.2123e-05
  hostname: veuc10
  iterations_since_restore: 4
  node_ip: 172.26.105.110
  pid: 22156
  should_checkpoint: true
  time_since_restore: 16.274818897247314
  time_this_iter_s: 0.25397777557373047
  time_total_s: 16.274818897247314
  timestamp: 1610913596
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 87df0_00000
  valid_acc: 0.0
  valid_loss: 19.3716983795166
  
[2m[36m(pid=22156)[0m Outputs training/eval saved on epoch 20
[2m[36m(pid=22154)[0m Epoch: 1, Loss: 55.066856384277344
[2m[36m(pid=22154)[0m Epoch: 2, Loss: 55.002586364746094
[2m[36m(pid=22154)[0m Epoch: 3, Loss: 55.06983184814453
[2m[36m(pid=22154)[0m Epoch: 4, Loss: 54.8746223449707
[2m[36m(pid=22154)[0m Epoch: 5, Loss: 55.019283294677734
[2m[36m(pid=22154)[0m Validation Loss: 19.89405059814453, Accuracy: 0.0
Result for inner_87df0_00001:
  date: 2021-01-17_20-00-10
  done: false
  experiment_id: bb33fe69fa564b068276d8cf6022c424
  experiment_tag: 1_dropout=0.1,epochs=1000,hidden_fc=2048,hidden_lstm=2048,lr=1.3354e-06
  hostname: veuc10
  iterations_since_restore: 1
  node_ip: 172.26.105.110
  pid: 22154
  should_checkpoint: true
  time_since_restore: 11.495843410491943
  time_this_iter_s: 11.495843410491943
  time_total_s: 11.495843410491943
  timestamp: 1610913610
  timesteps_since_restore: 0
  training_iteration: 1
  trial_id: 87df0_00001
  valid_acc: 0.0
  valid_loss: 19.89405059814453
  
[2m[36m(pid=22154)[0m Outputs training/eval saved on epoch 5
== Status ==
Memory usage on this node: 23.2/503.6 GiB
Using AsyncHyperBand: num_stopped=1
Bracket: Iter 4.000: None | Iter 2.000: None | Iter 1.000: -19.89405059814453
Bracket: Iter 4.000: None | Iter 2.000: -19.3868408203125
Resources requested: 4/16 CPUs, 2/2 GPUs, 0.0/331.98 GiB heap, 0.0/100.93 GiB objects (0/1.0 accelerator_type:RTX)
Current best trial: 87df0_00000 with valid_loss=19.3716983795166 and parameters={'input': 4, 'hidden_lstm': 1024, 'hidden_fc': 512, 'output': 50, 'dropout': 0.1, 'lr': 1.2122558614830293e-05, 'epochs': 1000, 'path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1', 'data_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/data', 'output_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/training_output'}
Result logdir: /home/usuaris/veu/lluis.guardia/ray_results/inner_2021-01-17_19-59-38
Number of trials: 2/2 (1 RUNNING, 1 TERMINATED)
+-------------------+------------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+
| Trial name        | status     | loc                  |   dropout |   epochs |   hidden_fc |   hidden_lstm |          lr |   iter |   total time (s) |   valid_loss |   valid_acc |
|-------------------+------------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------|
| inner_87df0_00001 | RUNNING    | 172.26.105.110:22154 |       0.1 |     1000 |        2048 |          2048 | 1.33543e-06 |      1 |          11.4958 |      19.8941 |           0 |
| inner_87df0_00000 | TERMINATED |                      |       0.1 |     1000 |         512 |          1024 | 1.21226e-05 |      4 |          16.2748 |      19.3717 |           0 |
+-------------------+------------+----------------------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+


[2m[36m(pid=22154)[0m Epoch: 6, Loss: 55.11282730102539
[2m[36m(pid=22154)[0m Epoch: 7, Loss: 54.895774841308594
[2m[36m(pid=22154)[0m Epoch: 8, Loss: 54.899600982666016
[2m[36m(pid=22154)[0m Epoch: 9, Loss: 54.64217758178711
[2m[36m(pid=22154)[0m Epoch: 10, Loss: 54.711055755615234
[2m[36m(pid=22154)[0m Validation Loss: 19.88988494873047, Accuracy: 0.0
[2m[36m(pid=22154)[0m Outputs training/eval saved on epoch 10
[2m[36m(pid=22154)[0m Epoch: 11, Loss: 54.69923400878906
[2m[36m(pid=22154)[0m Epoch: 12, Loss: 54.84101486206055
[2m[36m(pid=22154)[0m Epoch: 13, Loss: 54.494956970214844
[2m[36m(pid=22154)[0m Epoch: 14, Loss: 54.47272872924805
[2m[36m(pid=22154)[0m Epoch: 15, Loss: 54.852603912353516
[2m[36m(pid=22154)[0m Validation Loss: 19.885923385620117, Accuracy: 0.0
[2m[36m(pid=22154)[0m Outputs training/eval saved on epoch 15
[2m[36m(pid=22154)[0m Epoch: 16, Loss: 54.736507415771484
[2m[36m(pid=22154)[0m Epoch: 17, Loss: 54.699928283691406
[2m[36m(pid=22154)[0m Epoch: 18, Loss: 54.658729553222656
[2m[36m(pid=22154)[0m Epoch: 19, Loss: 54.49367141723633
[2m[36m(pid=22154)[0m Epoch: 20, Loss: 54.55324935913086
[2m[36m(pid=22154)[0m Validation Loss: 19.881977081298828, Accuracy: 0.0
Result for inner_87df0_00001:
  date: 2021-01-17_20-00-13
  done: true
  experiment_id: bb33fe69fa564b068276d8cf6022c424
  experiment_tag: 1_dropout=0.1,epochs=1000,hidden_fc=2048,hidden_lstm=2048,lr=1.3354e-06
  hostname: veuc10
  iterations_since_restore: 4
  node_ip: 172.26.105.110
  pid: 22154
  should_checkpoint: true
  time_since_restore: 14.428681373596191
  time_this_iter_s: 0.9762837886810303
  time_total_s: 14.428681373596191
  timestamp: 1610913613
  timesteps_since_restore: 0
  training_iteration: 4
  trial_id: 87df0_00001
  valid_acc: 0.0
  valid_loss: 19.881977081298828
  
== Status ==
Memory usage on this node: 23.1/503.6 GiB
Using AsyncHyperBand: num_stopped=2
Bracket: Iter 4.000: None | Iter 2.000: -19.88988494873047 | Iter 1.000: -19.89405059814453
Bracket: Iter 4.000: None | Iter 2.000: -19.3868408203125
Resources requested: 0/16 CPUs, 0/2 GPUs, 0.0/331.98 GiB heap, 0.0/100.93 GiB objects (0/1.0 accelerator_type:RTX)
Current best trial: 87df0_00000 with valid_loss=19.3716983795166 and parameters={'input': 4, 'hidden_lstm': 1024, 'hidden_fc': 512, 'output': 50, 'dropout': 0.1, 'lr': 1.2122558614830293e-05, 'epochs': 1000, 'path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1', 'data_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/data', 'output_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/training_output'}
Result logdir: /home/usuaris/veu/lluis.guardia/ray_results/inner_2021-01-17_19-59-38
Number of trials: 2/2 (2 TERMINATED)
+-------------------+------------+-------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+
| Trial name        | status     | loc   |   dropout |   epochs |   hidden_fc |   hidden_lstm |          lr |   iter |   total time (s) |   valid_loss |   valid_acc |
|-------------------+------------+-------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------|
| inner_87df0_00000 | TERMINATED |       |       0.1 |     1000 |         512 |          1024 | 1.21226e-05 |      4 |          16.2748 |      19.3717 |           0 |
| inner_87df0_00001 | TERMINATED |       |       0.1 |     1000 |        2048 |          2048 | 1.33543e-06 |      4 |          14.4287 |      19.882  |           0 |
+-------------------+------------+-------+-----------+----------+-------------+---------------+-------------+--------+------------------+--------------+-------------+


Best trial config: {'input': 4, 'hidden_lstm': 1024, 'hidden_fc': 512, 'output': 50, 'dropout': 0.1, 'lr': 1.2122558614830293e-05, 'epochs': 1000, 'path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1', 'data_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/data', 'output_path': '/home/usuaris/veu/lluis.guardia/youtubeViewsProject/model1/training_output'}
Best trial final validation loss: 19.3716983795166
Best trial final validation accuracy: 0.0
[2m[36m(pid=22154)[0m Outputs training/eval saved on epoch 20
Model saved

Best trial test set accuracy:
The model outputs 0.00% (0/5) of correct values with a margin of 0
The model outputs 0.00% (0/5) of correct values with a margin of 1
The model outputs 0.00% (0/5) of correct values with a margin of 2
The model outputs 20.00% (1/5) of correct values with a margin of 10
FINISHED TRAINING AND TESTING!
